!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.MagicGrid=i()}(this,function(){"use strict";var t=function(t){t.container||i("container"),t.items||t.static||i("items or static")},i=function(t){throw new Error("Missing property '"+t+"' in MagicGrid config")},e=function(t){var i=t[0];for(var e of t)e.height>i.height&&(i=e);return i},n=function(t){var i=t[0];for(var e of t)e.height<i.height&&(i=e);return i},o=function(i){t(i),this.containerClass=i.container,this.container=document.querySelector(i.container),this.item=this.container.children,this.static=i.static||!1,this.size=i.items,this.gutter=i.gutter||25,this.maxColumns=i.maxColumns||!1,this.useMin=i.useMin||!1,this.animate=i.animate||!1,this.started=!1,this.init()};return o.prototype.init=function(){if(this.ready()&&!this.started){this.container.style.position="relative";for(var t=0;t<this.item.length;t++)this.item[t].style.position="absolute",this.animate&&(this.item[t].style.transition="top,left 0.2s ease");this.started=!0}},o.prototype.colWidth=function(){return this.item[0].getBoundingClientRect().width+this.gutter},o.prototype.setup=function(){var t=this.container.getBoundingClientRect().width,i=Math.floor(t/this.colWidth())||1,e=[];this.maxColumns&&i>this.maxColumns&&(i=this.maxColumns);for(var n=0;n<i;n++)e[n]={height:0,top:0,index:n};return{cols:e,wSpace:t-i*this.colWidth()+this.gutter}},o.prototype.nextCol=function(t,i){return this.useMin?n(t):t[i%t.length]},o.prototype.positionItems=function(){var t=this.setup(),i=t.cols,n=t.wSpace;n=Math.floor(n/2);for(var o=0;o<this.item.length;o++){var s=this.nextCol(i,o),r=s.index*this.colWidth()+n,h=this.item[o];h.style.left=r+"px",h.style.top=s.height+s.top+"px",s.height+=s.top+h.getBoundingClientRect().height,s.top=this.gutter}this.container.style.height=e(i).height},o.prototype.ready=function(){return!!this.static||this.container.length>0&&this.item.length===this.size},o.prototype.getReady=function(){var t=this,i=setInterval(function(){t.container=document.querySelector(t.containerClass),t.item=t.container.children,t.ready()&&(clearInterval(i),t.init(),t.listen())},100)},o.prototype.listen=function(){var t=this;this.ready()?(this.positionItems(),window.addEventListener("resize",function(){setTimeout(t.positionItems(),200)})):this.getReady()},o});
